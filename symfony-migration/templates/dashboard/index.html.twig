{% extends 'base.html.twig' %}

{% block title %}OYSTERCULT - Tableau de bord{% endblock %}

{% block body %}
<div class="space-y-6">
    <div class="flex items-center space-x-3">
        <h1 class="text-xl font-bold text-white">Tableau de bord</h1>
    </div>

    <div class="dashboard-grid">
        {# Conditions actuelles #}
        <div class="dashboard-card">
            <div class="card-header">
                <h2 class="card-title">Conditions actuelles</h2>
            </div>
            
            <div class="weather-grid">
                <div class="weather-item">
                    <div class="weather-icon">
                        <i class="fas fa-temperature-high"></i>
                    </div>
                    <div class="weather-label">Température</div>
                    <div class="weather-value">18°C</div>
                    <div class="text-xs text-gray-400">Légère brise en approche</div>
                </div>
                <div class="weather-item">
                    <div class="weather-icon">
                        <i class="fas fa-tint"></i>
                    </div>
                    <div class="weather-label">Humidité</div>
                    <div class="weather-value">75%</div>
                </div>
                <div class="weather-item">
                    <div class="weather-icon">
                        <i class="fas fa-wind"></i>
                    </div>
                    <div class="weather-label">Vitesse</div>
                    <div class="weather-value">13 km/h</div>
                </div>
                <div class="weather-item">
                    <div class="weather-icon">
                        <i class="fas fa-water"></i>
                    </div>
                    <div class="weather-label">Marée</div>
                    <div class="weather-value">0</div>
                </div>
            </div>
        </div>

        {# État de la mer #}
        <div class="dashboard-card">
            <div class="card-header">
                <h2 class="card-title">État de la mer</h2>
            </div>
            
            <div class="weather-grid">
                <div class="weather-item">
                    <div class="weather-icon">
                        <i class="fas fa-ruler-vertical"></i>
                    </div>
                    <div class="weather-label">Hauteur</div>
                    <div class="weather-value">0.3m</div>
                </div>
                <div class="weather-item">
                    <div class="weather-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div class="weather-label">Coefficient</div>
                    <div class="weather-value">95</div>
                </div>
                <div class="weather-item">
                    <div class="weather-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="weather-label">Prochain</div>
                    <div class="weather-value">14:30</div>
                </div>
                <div class="weather-item">
                    <div class="weather-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="weather-label">Coefficient</div>
                    <div class="weather-value">20:45</div>
                </div>
            </div>
        </div>
    </div>

    {# Conditions de vent #}
    <div class="dashboard-card">
        <div class="card-header">
            <h2 class="card-title">Conditions de vent</h2>
        </div>
        
        <div class="weather-grid">
            <div class="weather-item">
                <div class="weather-icon">
                    <i class="fas fa-tachometer-alt"></i>
                </div>
                <div class="weather-label">Vitesse</div>
                <div class="weather-value">15 km/h</div>
            </div>
            <div class="weather-item">
                <div class="weather-icon">
                    <i class="fas fa-compass"></i>
                </div>
                <div class="weather-label">Direction</div>
                <div class="weather-value">NO</div>
            </div>
            <div class="weather-item">
                <div class="weather-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="weather-label">Prochain</div>
                <div class="weather-value">14:30</div>
            </div>
            <div class="weather-item">
                <div class="weather-icon">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <div class="weather-label">Coefficient</div>
                <div class="weather-value">20:45</div>
            </div>
        </div>
    </div>

    {# Prévisions horaires #}
    <div class="dashboard-card">
        <div class="card-header">
            <h2 class="card-title">Prévisions horaires</h2>
        </div>
        
        <div class="weather-grid">
            <div class="weather-item">
                <div class="weather-icon">
                    <i class="fas fa-cloud-sun"></i>
                </div>
                <div class="weather-label">12h00</div>
                <div class="weather-value">18°C</div>
                <div class="text-xs text-gray-400">0.3m</div>
            </div>
            <div class="weather-item">
                <div class="weather-icon">
                    <i class="fas fa-sun"></i>
                </div>
                <div class="weather-label">15h00</div>
                <div class="weather-value">19°C</div>
                <div class="text-xs text-gray-400">0.3m</div>
            </div>
            <div class="weather-item">
                <div class="weather-icon">
                    <i class="fas fa-cloud"></i>
                </div>
                <div class="weather-label">18h00</div>
                <div class="weather-value">17°C</div>
                <div class="text-xs text-gray-400">1m</div>
            </div>
            <div class="weather-item">
                <div class="weather-icon">
                    <i class="fas fa-moon"></i>
                </div>
                <div class="weather-label">21h00</div>
                <div class="weather-value">16°C</div>
                <div class="text-xs text-gray-400">0.5m</div>
            </div>
        </div>
    </div>

    <div class="dashboard-grid">
        {# Occupation des tables #}
        <div class="dashboard-card">
            <div class="card-header">
                <h2 class="card-title">Occupation des tables</h2>
                <div class="card-subtitle">4 tables actives</div>
            </div>
            
            <div class="space-y-4">
                {% for table in tableOccupancyData %}
                <div class="table-item">
                    <div class="item-info">
                        <div class="item-title">{{ table.name }}</div>
                        <div class="item-subtitle">{{ table.type }}</div>
                    </div>
                    <div class="item-status">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: {{ table.value }}%; background-color: {{ table.color }};"></div>
                        </div>
                        <div class="progress-value">{{ table.value }}%</div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        {# Santé des bassins #}
        <div class="dashboard-card">
            <div class="card-header">
                <h2 class="card-title">Santé des bassins</h2>
                <div class="card-subtitle">3 bassins actifs</div>
            </div>
            
            <div class="space-y-4">
                {% for pool in poolData %}
                <div class="pool-item">
                    <div class="item-info">
                        <div class="item-title">{{ pool.name }}</div>
                        <div class="item-subtitle">{{ pool.type }}</div>
                    </div>
                    <div class="item-status">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: {{ pool.value }}%; background-color: {{ pool.color }};"></div>
                        </div>
                        <div class="progress-value">{{ pool.value }}%</div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    {# Graphique d'évolution #}
    <div class="dashboard-card">
        <div class="card-header">
            <h2 class="card-title">Évolution de la production</h2>
            <div class="card-subtitle">6 derniers mois</div>
        </div>
        
        <div class="chart-container">
            <canvas id="productionChart"></canvas>
        </div>
    </div>

    {# Statistiques générales #}
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="stat-value">156,000</div>
            <div class="stat-label">Revenu total</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-calendar"></i>
            </div>
            <div class="stat-value">15/06</div>
            <div class="stat-label">Prochaine récolte</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="stat-value">19/02</div>
            <div class="stat-label">Contrôle Affaires Maritimes</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-water"></i>
            </div>
            <div class="stat-value">2.4</div>
            <div class="stat-label">Taux de mortalité moyen</div>
        </div>
    </div>

    {# Alertes récentes #}
    <div class="dashboard-card">
        <div class="card-header">
            <h2 class="card-title">Alertes récentes</h2>
            <div class="card-subtitle">5 alertes non résolues</div>
        </div>
        
        <div class="alerts-list">
            <div class="alert-item alert-warning">
                <div class="alert-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">Niveau d'oxygène bas - Bassin B1</div>
                    <div class="alert-time">Il y a 2 heures</div>
                </div>
                <div class="alert-action">
                    <button class="action-button">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
            </div>
            
            <div class="alert-item alert-danger">
                <div class="alert-icon">
                    <i class="fas fa-radiation"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">Contamination détectée - Table A2</div>
                    <div class="alert-time">Il y a 5 heures</div>
                </div>
                <div class="alert-action">
                    <button class="action-button">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
            </div>
            
            <div class="alert-item alert-info">
                <div class="alert-icon">
                    <i class="fas fa-thermometer-half"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">Variation de température - Bassin A1</div>
                    <div class="alert-time">Il y a 1 jour</div>
                </div>
                <div class="alert-action">
                    <button class="action-button">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
            </div>
            
            <div class="alert-item alert-warning">
                <div class="alert-icon">
                    <i class="fas fa-tint-slash"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">Qualité d'eau dégradée - Bassin A2</div>
                    <div class="alert-time">Il y a 2 jours</div>
                </div>
                <div class="alert-action">
                    <button class="action-button">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
            </div>
            
            <div class="alert-item alert-info">
                <div class="alert-icon">
                    <i class="fas fa-clipboard-check"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">Maintenance programmée - Système de filtration</div>
                    <div class="alert-time">Dans 3 jours</div>
                </div>
                <div class="alert-action">
                    <button class="action-button">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script>
    // Script pour les graphiques et les animations du dashboard
    document.addEventListener('DOMContentLoaded', function() {
        // Initialisation du graphique de production
        const ctx = document.getElementById('productionChart').getContext('2d');
        
        // Configuration du graphique
        const productionChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin'],
                datasets: [
                    {
                        label: 'Production (tonnes)',
                        data: [12, 19, 15, 17, 22, 24],
                        borderColor: 'rgb(56, 189, 248)',
                        backgroundColor: 'rgba(56, 189, 248, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Objectif',
                        data: [15, 15, 16, 18, 20, 22],
                        borderColor: 'rgba(255, 255, 255, 0.5)',
                        borderDash: [5, 5],
                        borderWidth: 1,
                        pointRadius: 0,
                        tension: 0.4,
                        fill: false
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            color: 'rgba(255, 255, 255, 0.7)',
                            font: {
                                family: 'Inter'
                            }
                        }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        backgroundColor: 'rgba(22, 33, 62, 0.9)',
                        titleColor: 'white',
                        bodyColor: 'rgba(255, 255, 255, 0.8)',
                        borderColor: 'rgba(255, 255, 255, 0.1)',
                        borderWidth: 1
                    }
                },
                scales: {
                    x: {
                        grid: {
                            color: 'rgba(255, 255, 255, 0.05)'
                        },
                        ticks: {
                            color: 'rgba(255, 255, 255, 0.7)'
                        }
                    },
                    y: {
                        grid: {
                            color: 'rgba(255, 255, 255, 0.05)'
                        },
                        ticks: {
                            color: 'rgba(255, 255, 255, 0.7)'
                        }
                    }
                }
            }
        });
        
        // Animation pour les alertes
        const alertItems = document.querySelectorAll('.alert-item');
        alertItems.forEach((item, index) => {
            item.style.animationDelay = `${index * 0.1}s`;
        });
    });
</script>
{% endblock %}
